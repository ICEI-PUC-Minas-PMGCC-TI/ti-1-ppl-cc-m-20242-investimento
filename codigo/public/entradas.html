<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página de Finanças</title>
</head>
<body>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #ccc;
            padding: 10px;
        }

        header nav button {
            margin-right: 10px;
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
        }

        main {
            display: flex;
            justify-content: space-around;
            margin: 20px;
        }

        section {
            background-color: #e0e0e0;
            padding: 20px;
            width: 30%;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table th, table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        button {
            margin-top: 10px;
            padding: 8px 12px;
            background-color: #333;
            color: white;
            border: none;
            cursor: pointer;
        }

        #noticias-container .noticia {
            background-color: #ccc;
            padding: 10px;
            margin-bottom: 10px;
        }

        .navbutton {
            color:#333;
            font-weight: bold;
        }

    </style>
    <header>
        <nav>
            <button class="navbutton">PÁGINA INICIAL</button>
            <button class="navbutton">GUIA DE OPÇÕES</button>
            <button class="navbutton">PESQUISA</button>
        </nav>
    </header>

    <main>
        <section id="gastos-mensais">
            <h2>SEUS GASTOS MENSAIS</h2>
            <table>
                <thead>
                    <tr>
                        <th>GASTO</th>
                        <th>VALOR</th>
                    </tr>
                </thead>
                <tbody id="gastos-body">
                    <!-- Gastos serão carregados aqui -->
                </tbody>
            </table>
            <p id="total-gastos">TOTAL: R$0,00</p>
            <button onclick="adicionarGasto()">Adicionar Gasto</button>
        </section>

        <section id="renda-passiva">
            <h2>SUA RENDA PASSIVA</h2>
            <table>
                <thead>
                    <tr>
                        <th>INVESTIMENTO</th>
                        <th>TOTAL INVESTIDO</th>
                        <th>RENDA MÉDIA</th>
                    </tr>
                </thead>
                <tbody id="renda-body">
                    <!-- Rendas serão carregadas aqui -->
                </tbody>
            </table>
            <p id="total-renda">TOTAL: R$0,00</p>
            <button onclick="adicionarRenda()">Adicionar Renda</button>
        </section>

        <section id="noticias">
            <h2>NOTÍCIAS E COMO AFETAM SUA RENDA</h2>
            <div id="noticias-container">
                <!-- Notícias serão carregadas aqui -->
            </div>
        </section>
    </main>

    <script>// URL do json-server
        const apiUrl = "http://localhost:3000";
        
        // Função para carregar os gastos do servidor
        async function carregarGastos() {
            const response = await fetch(`${apiUrl}/entrada?tipo=gasto`);
            const gastos = await response.json();
            const gastosBody = document.getElementById("gastos-body");
            let totalGastos = 0;
        
            gastosBody.innerHTML = "";
            gastos.forEach(gasto => {
                totalGastos += gasto.valor;
                const row = `<tr><td>${gasto.nome}</td><td>R$${gasto.valor.toFixed(2)}</td></tr>`;
                gastosBody.innerHTML += row;
            });
        
            document.getElementById("total-gastos").innerText = `TOTAL: R$${totalGastos.toFixed(2)}`;
        }
        
        // Função para carregar a renda passiva do servidor
        async function carregarRenda() {
            const response = await fetch(`${apiUrl}/entrada?tipo=investimento`);
            const rendas = await response.json();
            const rendaBody = document.getElementById("renda-body");
            let totalRenda = 0;
        
            rendaBody.innerHTML = "";
            rendas.forEach(renda => {
                totalRenda += renda.valor;
                const row = `<tr><td>${renda.nome}</td><td>R$${renda.valor.toFixed(2)}</td><td>R$${renda.valor.toFixed(2)}</td></tr>`;
                rendaBody.innerHTML += row;
            });
        
            document.getElementById("total-renda").innerText = `TOTAL: R$${totalRenda.toFixed(2)}`;
        }
        
        // Função para carregar as notícias do servidor
        async function carregarNoticias() {
            const response = await fetch(`${apiUrl}/noticias`);
            const noticias = await response.json();
            const noticiasContainer = document.getElementById("noticias-container");
        
            noticiasContainer.innerHTML = "";
            noticias.forEach(noticia => {
                const noticiaElement = `
                    <div class="noticia">
                        <h3>${noticia.titulo}</h3>
                        <p>${noticia.data}</p>
                        <p>${noticia.descricao}</p>
                    </div>
                `;
                noticiasContainer.innerHTML += noticiaElement;
            });
        }
        
        // Função para adicionar um gasto
        async function adicionarGasto() {
            const nome = prompt("Digite o nome do gasto:");
            const valor = parseFloat(prompt("Digite o valor do gasto:"));
            if (!nome || isNaN(valor)) return alert("Entrada inválida!");
        
            await fetch(`${apiUrl}/entrada`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    nome,
                    valor,
                    tipo: "gasto",
                    usuario_id: "12345", // Substitua pelo ID real do usuário
                    recorrente: true,
                })
            });
            carregarGastos();
        }
        
        // Função para adicionar uma renda
        async function adicionarRenda() {
            const nome = prompt("Digite o nome do investimento:");
            const valor = parseFloat(prompt("Digite o valor investido:"));
            if (!nome || isNaN(valor)) return alert("Entrada inválida!");
        
            await fetch(`${apiUrl}/entrada`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    nome,
                    valor,
                    tipo: "investimento",
                    usuario_id: "12345", // Substitua pelo ID real do usuário
                    recorrente: true,
                })
            });
            carregarRenda();
        }
        
        // Carrega dados iniciais
        carregarGastos();
        carregarRenda();
        carregarNoticias();
        </script>
</body>
</html>
